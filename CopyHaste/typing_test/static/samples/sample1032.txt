
MAX_SEQNO = 0xFFFFFFFFFFFFFFFF
class DcpClient(MemcachedClient):
	def __init__(self, host='127.0.0.1', port=11210, timeout=1):
		super(DcpClient, self).__init__(host, port, timeout)
		self.timeout = timeout
		self.streams = {}
		self.ops = {}
		self.dead = False
	def _open(self, op):
		return self._handle_op(op)
	def close(self):
		super(DcpClient, self).close()
		self.dead = True
	def open_consumer(self, name):
		op = OpenConsumer(name)
		return self._open(op)
	def open_producer(self, name):
		op = OpenProducer(name)
		return self._open(op)
	def open_notifier(self, name):
		op = OpenNotifier(name)
		return self._open(op)
	def get_failover_log(self, vbucket):
		op = GetFailoverLog(vbucket)
		return self._handle_op(op)
	def flow_control(sel