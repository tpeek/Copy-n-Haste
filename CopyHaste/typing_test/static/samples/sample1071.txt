
LOG = logging.getLogger(__name__)
_LE = i18n._LE
class TaskExecutor(object):
	def __init__(self, context, task_repo, image_repo, image_factory):
		self.context = context
		self.task_repo = task_repo
		self.image_repo = image_repo
		self.image_factory = image_factory
	def begin_processing(self, task_id):
		task = self.task_repo.get(task_id)
		task.begin_processing()
		self.task_repo.save(task)
		self._run(task_id, task.type)
	def _run(self, task_id, task_type):
		task = self.task_repo.get(task_id)
		msg = _LE("This execution of Tasks is not setup. Please consult the "
				  "project documentation for more information on the "
				  "executors available.")
		LOG.error(msg)
		task.fail(_LE("Internal error occurred while trying to process task