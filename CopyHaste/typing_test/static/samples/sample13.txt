inbox_db_engine = main_engine(pool_size=1)
basic_engine = sqlalchemy.create_engine(
	engine_uri(), listeners=[ForceStrictMode()], echo=False)
@click.command()
@click.option('--prod/--no-prod', default=False,
			  help='Disable creating the test database for production '
				   'deployments')
def main(prod):
	if not prod:
		print 'Creating database: test'
		basic_engine.execute(
			"CREATE DATABASE IF NOT EXISTS test DEFAULT CHARACTER SET utf8mb4 "
			"DEFAULT COLLATE utf8mb4_general_ci")
		basic_engine.execute("GRANT ALL PRIVILEGES ON test.* TO "
							 "inboxtest@localhost IDENTIFIED BY 'inboxtest'")
	mysql_user = config.get_required('MYSQL_USER')
	mysql_database = config.get_required('MYSQL_DATABASE')
	print 'Creating database: {}'.format(mysql_database)
	basic_engine.execute("CREATE DATABASE IF NOT EXISTS {} DEFAULT CHARACTER "
						 "SET utf8mb4 DEFAULT COLLATE utf8mb4_general_ci;".
						 format(mysql_database))
	basic_engine.execute("GRANT ALL PRIVILEGES ON {mysql_database}.* TO "
						 "{mysql_user}@localhost IDENTIFIED BY '{mysql_user}'".
						 format(mysql_user=mysql_user,
								mysql_database=mysql_database))
	init_db(inbox_db_engine)
	if inbox_db_engine.dialect.has