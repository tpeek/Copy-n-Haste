
file = open('./'+'user_taggedbookmarks-timestamps.dat', 'r')
file.readline()
raw_user_bookmark_tag = []
max = 1000000
for line in file:
	max -= 1
	if max<0:
		break
	arr = line.strip().split('\t')
	t = {}
	t['uid'] = int(arr[0])
	t['aid'] = int(arr[1])
	t['tid'] = int(arr[2])
	t['tstamp'] = int(arr[3])
	raw_user_bookmark_tag.append(t)
	
print 'raw event number: '+str(len(raw_user_bookmark_tag))
ftagremove = open('./'+'tag_remove','w')
tag_count = defaultdict(int)
tag_remove = Set([])
for t in raw_user_bookmark_tag:
	tag_count[t['tid']] += 1
for tid in tag_count:
	if tag_count[tid] < 10:
		ftagremove.write(str(tid)+'\n')
		tag_remove.add(tid)
print 'removed tags: '+str(len(tag_remove))
vocab = {}
tag2word = {}
file = open('./'+'tags.dat', '