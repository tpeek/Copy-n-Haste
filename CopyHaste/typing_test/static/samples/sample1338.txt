
try:
	urlquote = urlparse.quote
	urlunquote = urlparse.unquote
except ImportError:
	urlquote = urllib2.quote
	urlunquote = urllib2.unquote


class ParentProxy(object):
	via = None
	DEFAULT_TIMEOUT = 8

	def __init__(self, name, proxy):
		proxy, _, priority = proxy.partition(' ')
		httppriority, _, httpspriority = priority.partition(' ')
		httpspriority, _, timeout = httpspriority.partition(' ')
		httppriority = httppriority or 99
		httpspriority = httpspriority or httppriority
		timeout = timeout or self.DEFAULT_TIMEOUT

		if proxy == 'direct':
			proxy = ''
		elif proxy and '//' not in proxy:
			proxy = 'http://' + proxy
		self.name = name
		proxy_list = proxy.split('|')
		self.proxy = proxy_list[0]
		if len(proxy_l