
						unicode_literals)
needs_ghostscript = knownfailureif(
	matplotlib.checkdep_ghostscript()[0] is None,
	"This test needs a ghostscript installation")
needs_tex = knownfailureif(
	not matplotlib.checkdep_tex(),
	"This test needs a TeX installation")
def _test_savefig_to_stringio(format='ps'):
	buffers = [
		six.moves.StringIO(),
		io.StringIO(),
		io.BytesIO()]
	plt.figure()
	plt.plot([0, 1], [0, 1])
	plt.title("Déjà vu")
	for buffer in buffers:
		plt.savefig(buffer, format=format)
	values = [x.getvalue() for x in buffers]
	if six.PY3:
		values = [
			values[0].encode('ascii'),
			values[1].encode('ascii'),
			values[2]]
	values = [re.sub(b'%%.*?\n', b'', x) for x in values]
	assert values[0] == values[1]
	assert values[1] == values[2