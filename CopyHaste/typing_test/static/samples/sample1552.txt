
log = logging.getLogger('common.ssl')
def generate_key(key_length):
	k = crypto.PKey()
	k.generate_key(crypto.TYPE_RSA, key_length)
	return k
def create_certificate(cert_info):
	cert = crypto.X509()
	cert.get_subject().C = cert_info['country']
	cert.get_subject().ST = cert_info['state']
	cert.get_subject().L = cert_info['city']
	cert.get_subject().O = cert_info['organization']
	cert.get_subject().CN = cert_info['common']
	cert.get_subject().emailAddress = cert_info['email']
	serial = cert_info.get('serial')
	if serial is not None:
		cert.set_serial_number(serial)
	cert.gmtime_adj_notBefore(0)
	cert.gmtime_adj_notAfter(cert_info['lifetime'] * (60*60*24))
	cert.set_issuer(cert.get_subject())
	cert.set_version(2)
	return cert
def create_self_