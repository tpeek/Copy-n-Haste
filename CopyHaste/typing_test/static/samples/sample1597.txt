
class DivxstageResolver(Plugin, UrlResolver, PluginSettings):
	implements = [UrlResolver, PluginSettings]
	name = "divxstage"
	domains = ["divxstage.eu", "divxstage.net", "divxstage.to", "cloudtime.to"]
	def __init__(self):
		p = self.get_setting('priority') or 100
		self.priority = int(p)
		self.net = Net()
	def get_media_url(self, host, media_id):
		web_url = self.get_url(host, media_id)
		try:
			html = self.net.http_GET(web_url).content
			r = re.search('<param name="src" value="(.+?)"', html)
			if r:
				stream_url = r.group(1)
			else:
				html = unwise.unwise_process(html)
				filekey = unwise.resolve_var(html, "flashvars.filekey")
				
				player_url = 'http://www.cloudtime.to/api/player.api.php?user=undefined&key='+filekey+'&pass