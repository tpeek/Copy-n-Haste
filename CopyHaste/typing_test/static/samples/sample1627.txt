
user_arm_tag = []
fin = open(sys.argv[1], 'r')
part1Num = int(sys.argv[2])
fin.readline()
last = {}
for line in fin:	
	arr = line.strip().split('\t')
	t = {}
	t['uid'] = int(arr[0])
	t['aid'] = int(arr[1])	
	t['tstamp'] = int(arr[3])
	if not t == last:
		last = t
		user_arm_tag.append(t)
print 'event number: '+str(len(user_arm_tag))
user_arm_pool = {}
arm_pool = Set([])
for t in user_arm_tag:
	arm_pool.add(t['aid'])
for t in user_arm_tag:
	if not (t['uid'] in user_arm_pool):
		user_arm_pool[t['uid']] = arm_pool.copy()		
	if t['aid'] in user_arm_pool[t['uid']]:
		user_arm_pool[t['uid']].remove(t['aid'])	
random.shuffle(user_arm_tag)
fout_Part1 = open(sys.argv[1].split('/')[1]+'/processed_events_shuffled_Part1_'+ str(part1Num)+ '.dat','w')
f