
DEBIAN_OLD_STYLE_BOOT_SEQUENCE = ('etch', '4.0', 'lenny')
class DebInit(Bcfg2.Client.Tools.SvcTool):
	name = 'DebInit'
	__execs__ = ['/usr/sbin/update-rc.d', '/usr/sbin/invoke-rc.d']
	__handles__ = [('Service', 'deb')]
	__req__ = {'Service': ['name', 'status']}
	svcre = \
		re.compile(r'/etc/.*/(?P<action>[SK])(?P<sequence>\d+)(?P<name>\S+)')
	def get_svc_command(self, service, action):
		return '/usr/sbin/invoke-rc.d %s %s' % (service.get('name'), action)
	def verify_bootstatus(self, entry, bootstatus):
		rawfiles = glob.glob("/etc/rc*.d/[SK]*%s" % (entry.get('name')))
		files = []
		try:
			deb_version = open('/etc/debian_version').read().split('/', 1)[0]
		except IOError:
			deb_version = 'unknown'
		if entry.get('sequence'):
			if (deb