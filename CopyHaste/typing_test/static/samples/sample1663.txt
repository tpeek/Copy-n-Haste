
class POSIXDevice(POSIXTool):
	__req__ = ['name', 'dev_type', 'mode', 'owner', 'group']
	def fully_specified(self, entry):
		if entry.get('dev_type') in ['block', 'char']:
			if (entry.get('major') is None or
					entry.get('minor') is None):
				return False
		return True
	def verify(self, entry, modlist):
		ondisk = self._exists(entry)
		if not ondisk:
			return False
		rv = True
		dev_type = entry.get('dev_type')
		if dev_type in ['block', 'char']:
			major = int(entry.get('major'))
			minor = int(entry.get('minor'))
			if major != os.major(ondisk.st_rdev):
				msg = ("Major number for device %s is incorrect. "
					   "Current major is %s but should be %s" %
					   (entry.get("name"), os.major(ondisk.st_rdev), major))
				self.logger.