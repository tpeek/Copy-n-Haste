
class POSIXDirectory(POSIXTool):
	__req__ = ['name', 'mode', 'owner', 'group']
	def verify(self, entry, modlist):
		ondisk = self._exists(entry)
		if not ondisk:
			return False
		if not stat.S_ISDIR(ondisk[stat.ST_MODE]):
			self.logger.info("POSIX: %s is not a directory" %
							 entry.get('name'))
			return False
		prune = True
		if entry.get('prune', 'false').lower() == 'true':
			try:
				extras = [os.path.join(entry.get('name'), ent)
						  for ent in os.listdir(entry.get('name'))
						  if os.path.join(entry.get('name'),
										  ent) not in modlist]
				if extras:
					prune = False
					msg = "Directory %s contains extra entries: %s" % \
						(entry.get('name'), "; ".join(extras))
					self.logger.info("POSIX: " + msg)
				