
waagent.LoggerInit('/tmp/test.log','/dev/stdout')
waagent.MyDistro = waagent.GetMyDistro()
class Dummy(object):
	pass
hutil = Dummy()
hutil.log = waagent.Log
class TestCreateNewAccount(unittest.TestCase):
	def test_creat_newuser(self):
		settings={}
		settings['username'] = 'NewUser'
		settings['password'] = 'User@123'
		waagent.Run('userdel %s' %settings['username'])
		vmaccess._set_user_account_pub_key(settings, hutil)
		waagent.Run("echo 'exit' > /tmp/exit.sh")
		cmd_result = waagent.RunGetOutput("sshpass -p 'User@123' ssh -o StrictHostKeyChecking=no" 
				+ " %s@localhost < /tmp/exit.sh" %settings['username'])
		self.assertEqual(cmd_result[0], 0)
		waagent.Run("rm exit.sh -f")
		waagent.Run('userdel %s' %settings['username'])
expected_