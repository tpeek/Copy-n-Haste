
odor_off = Dickinson_experiments.dick_pickle.main(plotting=False)
binspots = odor_off["acceleration"]['abs']['bin_centers']
normed_counts = odor_off["acceleration"]['abs']['normed_cts']
rand_samples = np.random.choice(binspots, 100000, p=normed_counts/normed_counts.sum())
shape, loc, scale = stats.lognorm.fit(rand_samples, floc=0)
mu = np.log(scale)
sigma = shape
geom_mean = np.exp(mu)
geom_stdev = np.exp(sigma)
plt.plot(binspots, stats.lognorm.pdf(binspots, shape, loc=0, scale=scale), 'r', linewidth=3, label='fit')
plt.legend()
plt.show()
print "shape/sigma, standard dev of log(X) = ", sigma
print "Geometric std dev = ", geom_stdev
print "loc = ", loc
print "scale = ", scale
print "mu / Mean of log(X) = ", mu
print "Geometric mean / media