__author__ = 'richard'
csv = np.gen
csv = csv.T
bin_edges = csv[0]
probabilities = csv[4]
rand_samples = np.random.choice(bin_edges, 1000, p=probabilities/probabilities.sum())
shape, loc, scale = stats.lognorm.fit(rand_samples, floc=0)
mu = np.log(scale)
sigma = shape
geom_mean = np.exp(mu)
geom_stdev = np.exp(sigma)
scale = 1.
SCALAR = 0.1
plt.plot(bin_edges, probabilities, lw=2, label='sharri data')
plt.plot(bin_edges, stats.lognorm.pdf(bin_edges, shape*0.5, loc=loc, scale=scale), 'r', linewidth=3, label='fit')
plt.legend()
plt.show()
print "shape/sigma, standard dev of log(X) = ", sigma
print "Geometric std dev = ", geom_stdev
print "loc = ", loc
print "scale = ", scale
print "mu = log(scale) = Mean of log(X) = ", mu
print "Geometric mea