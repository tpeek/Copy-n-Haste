
def encrypt(mode, key, iv, plaintext):
	cipher = base.Cipher(
		algorithms.SEED(binascii.unhexlify(key)),
		mode(binascii.unhexlify(iv)),
		backend
	)
	encryptor = cipher.encryptor()
	ct = encryptor.update(binascii.unhexlify(plaintext))
	ct += encryptor.finalize()
	return binascii.hexlify(ct)
def build_vectors(mode, filename):
	with open(filename, "r") as f:
		vector_file = f.read().splitlines()
	count = 0
	output = []
	key = None
	iv = None
	plaintext = None
	for line in vector_file:
		line = line.strip()
		if line.startswith("KEY"):
			if count != 0:
				output.append("CIPHERTEXT = {0}".format(
					encrypt(mode, key, iv, plaintext))
				)
			output.append("\nCOUNT = {0}".format(count))
			count += 1
			name, key = line.split(" = ")
			o