

def unroll_params(arr, d, len_voc, deep=1):

	mat_size = d * d
	ind = 0

	params = []
	for i in range(0, deep):
		params.append(arr[ind : ind + mat_size].reshape( (d, d) ))
		ind += mat_size
		params.append(arr[ind : ind + d].reshape( (d, 1) ))
		ind += d


	params.append(arr[ind : ind + len_voc * d].reshape( (d, len_voc)))
	return params
def roll_params(params):
	return concatenate( [p.ravel() for p in params])
def init_params(d, deep=1):
	params = []
	magic_number = 0.08
	for i in range(0, deep):
		params.append( (random.rand(d, d) * 2 - 1) * magic_number)
		params.append( (random.rand(d, 1) * 2 - 1) * magic_number)

	return params
def init_grads(d, len_voc, deep=1):

	grads = []
	for i in range(0, deep):
		gr