
class WinColor(object):
	BLACK   = 0
	BLUE	= 1
	GREEN   = 2
	CYAN	= 3
	RED	 = 4
	MAGENTA = 5
	YELLOW  = 6
	GREY	= 7
class WinStyle(object):
	NORMAL			  = 0x00
	BRIGHT			  = 0x08
	BRIGHT_BACKGROUND   = 0x80
class WinTerm(object):
	def __init__(self):
		self._default = win32.GetConsoleScreenBufferInfo(win32.STDOUT).wAttributes
		self.set_attrs(self._default)
		self._default_fore = self._fore
		self._default_back = self._back
		self._default_style = self._style
	def get_attrs(self):
		return self._fore + self._back * 16 + self._style
	def set_attrs(self, value):
		self._fore = value & 7
		self._back = (value >> 4) & 7
		self._style = value & (WinStyle.BRIGHT | WinStyle.BRIGHT_BACKGROUND)
	def reset_all(self, on_stderr=None):
		self.set_attrs(