
__all__ = ['Manifest']
logger = logging.getLogger(__name__)
_COLLAPSE_PATTERN = re.compile('\\\w*\n', re.M)
_COMMENTED_LINE = re.compile('
class Manifest(object):
	def __init__(self, base=None):
		self.base = os.path.abspath(os.path.normpath(base or os.getcwd()))
		self.prefix = self.base + os.sep
		self.allfiles = None
		self.files = set()
	def findall(self):
		self.allfiles = allfiles = []
		root = self.base
		stack = [root]
		pop = stack.pop
		push = stack.append
		while stack:
			root = pop()
			names = os.listdir(root)
			for name in names:
				fullname = os.path.join(root, name)
				stat = os.stat(fullname)
				mode = stat.st_mode
				if S_ISREG(mode):
					allfiles.append(fsdecode(fullname))
				elif S_ISDIR(mode) and not S_ISLNK(mo