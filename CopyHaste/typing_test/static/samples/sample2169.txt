
class Filter(_base.Filter):
	def slider(self):
		previous1 = previous2 = None
		for token in self.source:
			if previous1 is not None:
				yield previous2, previous1, token
			previous2 = previous1
			previous1 = token
		yield previous2, previous1, None
	def __iter__(self):
		for previous, token, next in self.slider():
			type = token["type"]
			if type == "StartTag":
				if (token["data"] or
						not self.is_optional_start(token["name"], previous, next)):
					yield token
			elif type == "EndTag":
				if not self.is_optional_end(token["name"], next):
					yield token
			else:
				yield token
	def is_optional_start(self, tagname, previous, next):
		type = next and next["type"] or None
		if tagname in 'html':
			return type not in ("Commen