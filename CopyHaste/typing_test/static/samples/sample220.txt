
__version__ = "0.2"
def i16(c):
	return ord(c[0]) + (ord(c[1])<<8)
def i32(c):
	return ord(c[0]) + (ord(c[1])<<8) + (ord(c[2])<<16) + (ord(c[3])<<24)
def _accept(prefix):
	return i16(prefix[4:6]) in [0xAF11, 0xAF12]
class FliImageFile(ImageFile.ImageFile):
	format = "FLI"
	format_description = "Autodesk FLI/FLC Animation"
	def _open(self):
		s = self.fp.read(128)
		magic = i16(s[4:6])
		if magic not in [0xAF11, 0xAF12]:
			raise SyntaxError, "not an FLI/FLC file"
		self.mode = "P"
		self.size = i16(s[8:10]), i16(s[10:12])
		duration = i32(s[16:20])
		if magic == 0xAF11:
			duration = (duration * 1000) / 70
		self.info["duration"] = duration
		palette = map(lambda a: (a,a,a), range(256))
		s = self.fp.read(16)
		self.__offset = 128
		if i16