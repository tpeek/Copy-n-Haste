
class FileSelection(object):
	def file_ok_sel(self, w, rsp):
		self.close(w)
		if rsp == 0:
			return
		
		filepath = self.filew.get_filename()
		self.callfn(filepath)
	def __init__(self, action=gtk.FILE_CHOOSER_ACTION_OPEN):
		self.filew = gtk.FileChooserDialog(title="Select a file",
										   action=action)
		self.filew.connect("destroy", self.close)
		if action == gtk.FILE_CHOOSER_ACTION_SAVE:
			self.filew.add_buttons(gtk.STOCK_SAVE, 1, gtk.STOCK_CANCEL, 0)
		else:
			self.filew.add_buttons(gtk.STOCK_OPEN, 1, gtk.STOCK_CANCEL, 0)
		self.filew.set_default_response(1)
		self.filew.connect("response", self.file_ok_sel)
	
	def popup(self, title, callfn, initialdir=None,
			  filename=None):
		self.callfn = callfn
		self.filew.set_title(