
toolkit = ginga.toolkit.toolkit
have_gtk3 = False
have_gtk2 = False
if toolkit in ('gtk2', 'choose'):
	try:
		pygtk.require('2.0')
		have_gtk2 = True
	
	except ImportError:
		pass
	
if toolkit in ('gtk3', 'choose') and (not have_gtk2):
	try:
		pygtkcompat.enable() 
		pygtkcompat.enable_gtk(version='3.0')
		have_gtk3 = True
	except ImportError:
		pass
if have_gtk3:
	raise Exception("Cairo.ImageSurface.create_for_data is not yet implemented in Gtk3")
	ginga.toolkit.use('gtk3')
	def pixbuf_new_
		xpm_data = bytes('\n'.join(xpm_data))
		return GdkPixbuf.Pixbuf.new_
	def pixbuf_new_
		daht, dawd, depth = data.shape
		stride = dawd * 4 * bpp
		rgb_buf = data.tostring(order='C')
		hasAlpha = False
		rgbtype = GdkPixbuf.Colorspace.RGB
		return Gdk