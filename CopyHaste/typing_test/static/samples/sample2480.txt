
__doc__ =
print(__doc__)
try:
except ImportError:
	raise RuntimeError("This script needs the matplotlib library")
dim = 2
x1 = nr.randn(25, dim)
x2 = 3 + 2 * nr.randn(15, dim)
x3 = np.repeat(np.array([-2, 2], ndmin=2), 10, 0) + 0.5 * nr.randn(10, dim)
x = np.concatenate((x1, x2, x3))
krange = range(1, 10)
be = - np.inf
for  k in krange:
	b = bgmm.VBGMM(k, dim)
	b.guess_priors(x)
	b.initialize(x)
	b.estimate(x)
	ek = float(b.evidence(x))
	if ek > be:
		be = ek
		bestb = b
	print(k, 'classes, free energy:', ek)
z = bestb.map_label(x)
plot2D(x, bestb, z, verbose=0)
plt.title('Variational Bayes')
niter = 1000
krange = range(1, 6)
bbf = - np.inf
for k in krange:
	b = bgmm.BGMM(k, dim)
	b.guess_priors(x)
	b.initialize(x)
	b.sample(x, 100)
	w, ce