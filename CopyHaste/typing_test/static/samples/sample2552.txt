
_discovered_plugins = {}
def discover_auth_systems():
	global _discovered_plugins
	_discovered_plugins = {}
	def add_plugin(ext):
		_discovered_plugins[ext.name] = ext.plugin
	ep_namespace = "openstack.common.apiclient.auth"
	mgr = extension.ExtensionManager(ep_namespace)
	mgr.map(add_plugin)
def load_auth_system_opts(parser):
	group = parser.add_argument_group("Common auth options")
	BaseAuthPlugin.add_common_opts(group)
	for name, auth_plugin in six.iteritems(_discovered_plugins):
		group = parser.add_argument_group(
			"Auth-system '%s' options" % name,
			conflict_handler="resolve")
		auth_plugin.add_opts(group)
def load_plugin(auth_system):
	try:
		plugin_class = _discovered_plugins[auth_system]
	except KeyError:
		raise exceptions.Au