__author__ = 'swebb'
mpl.rc('text', usetex=True)
try:
	dt = 1.e-8
	B = [1.e-5 * np.array([1., 0.1, 0.])]
	E = [1.e-5 * np.array([0., 0., 1.])]
	charge = consts.e
	mass = consts.electron_mass
	pusher = RbBorisVay(charge, mass, dt)
	x = []
	y = []
	z = []
	gamma = 3.
	uMag = consts.c * np.sqrt(gamma**2 - 1.)
	uDir = 1.4*np.pi
	uDir2 = 0.1*np.pi
	v0 = [np.array([uMag * np.cos(uDir) * np.sin(uDir2), uMag * np.sin(uDir) *
					np.sin(uDir2), uMag * np.cos(uDir2)])]
	x0 = [np.zeros(3)]
	x.append(x0[0][0])
	y.append(x0[0][1])
	z.append(x0[0][2])
	gammaArray = []
	gamma = np.sqrt(np.dot(v0[0], v0[0])/consts.c**2 + 1)
	gammaArray.append(gamma)
	x0 = pusher.halfmove(v0, x0, +1)
	for idx in range(10000):
		v0 = pusher.accelerate(v0, E, B)
		x0 = pushe