__author__ = 'swebb'
mpl.rc('text', usetex=True)
try:
	print 'testing BorisVay in a constant magnetic field'
	E0 = 0.
	B0 = 0.3
	B = np.array([[B0, 0., 0.]])
	E = np.array([[0., 0., 0.]])
	charge = consts.e
	mass = consts.electron_mass
	vNaught = 1.3e3
	gamma0 = np.sqrt(vNaught**2/consts.c**2 + 1)
	Omega = consts.e * B0/(gamma0*consts.m_e)
	dt = 0.1/Omega
	pusher = RbBorisVay(charge, mass, dt)
	v0 = np.array([[0., vNaught, 0.]])
	x0 = np.array([[0., 0., 0.]])
	nsteps = 1000
	t = 0.
	v = []
	vTheoretical = []
	x0 = pusher.halfmove(v0, x0, +1)
	t += 0.5*dt
	vyIdeal = [0.]*nsteps
	vyComp  = [0.]*nsteps
	vzIdeal = [0.]*nsteps
	vzComp  = [0.]*nsteps
	vError  = [0.]*nsteps
	tArray = []
	for idx in range(nsteps):
		v0 = pusher.accelerate(v0, E, B)