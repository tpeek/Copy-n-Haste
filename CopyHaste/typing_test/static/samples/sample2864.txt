def infer(model_root, save_location, corpus):
	model = ldamodel.LDAModel(0, 0)
	model.load_model(model_root)
	var_gamma = [[0 for x in range(model.num_topics)]
				 for x in range(corpus.num_docs)]
	filename = save_location + "-lda-likelihood.dat"
	file_pointer = open(filename, "w")
	for index in range(0, corpus.num_docs):
		if ((index % 100) == 0) and (index > 0):
			print("Document %d" % index)
		document = corpus.doc_list[index]
		phi = [[0 for x in range(model.num_topics)] for x in range(document.unique_word_count)]
		likelihood = util_functions.lda_inference(document, model, var_gamma[index], phi)
		file_pointer.write("%5.5f\n" % likelihood)
	file_pointer.close()
	filename = save_location + "-gamma.dat"
	file_utils.save_gamma(filename, var_gamma, corpus.num_docs, model.num_topics)
if __name__ == "__main__":
	if len(sys.argv) == 5:
		file_utils.read_settings(sys.argv[1])
		corpus = corpus.Corpus(sys.argv[3])
		infer(sys.argv[2], sys.argv[4], corpus)
	else:
		print("usage: lda_inference [settings] [model] [data] [name]")