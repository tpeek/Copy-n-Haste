def getNewString( theString ) :
	if( not theString or len(theString) ==0) :
		return ""
	if theString[0].isupper() and len(theString)>=2 and theString[1].isupper() :
		newString=theString[0:1].upper() + theString[1:].lower();
	elif theString[0].isupper():
		newString=theString.lower()
	else:
		newString=theString.upper()
	return newString;
def capitalisePython( ):
	xModel = XSCRIPTCONTEXT.getDocument()
	xSelectionSupplier = xModel.getCurrentController()
	xIndexAccess = xSelectionSupplier.getSelection()
	count = xIndexAccess.getCount();
	if(count>=1):
		i=0
	while i < count :
			xTextRange = xIndexAccess.getByIndex(i);
			theString = xTextRange.getString();
			if len(theString)==0 :
				xText = xTextRange.getText();
				xWordCursor = xText.createTextCursorByRange(xTextRange);
				if not xWordCursor.isStartOfWord():
					xWordCursor.gotoStartOfWord(False);
				xWordCursor.gotoNextWord(True);
				theString = xWordCursor.getString();
				newString = getNewString(theString);
				if newString :
					xWordCursor.setString(newString);
					xSelectionSupplier.select(xWordCursor);
			else :
				newString = getNewString( theString );
				if newString:
					xTextRange.setString(newString);
					xSelectionSupplier.select(xTextRange);
			i+= 1
g_exportedScripts = capitalisePython,