def findTranscription(timeDetail):
	file1 = open('exp/tri5a/decode_callhome_dev/scoring/13.tra')
	file2 = open('exp/tri5a/decode_callhome_train/scoring/13.tra')
	for line in file1:
		lineComp = line.split()
		if lineComp[0] == timeDetail:
			return " ".join(lineComp[1:])
	for line in file2:
		lineComp = line.split()
		if lineComp[0] == timeDetail:
			return " ".join(lineComp[1:])
	return -1
wordsFile = open('exp/tri5a/graph/words.txt')
words = {}
for line in wordsFile:
	lineComp = line.split()
	words[int(lineComp[1])] = lineComp[0].strip()
fileList = []
conversationList = open('/export/a04/gkumar/corpora/fishcall/jack-splits/split-callhome/train')
for line in conversationList: 
	line = line.strip()
	line = line[:-4]
	fileList.append(line)
if not os.path.exists('exp/tri5a/one-best/ch_train'):
	os.makedirs('exp/tri5a/one-best/ch_train')
provFile = open('/export/a04/gkumar/corpora/fishcall/jack-splits/split-callhome/asr.train', 'w+')
for item in fileList:
	timingFile = open('/export/a04/gkumar/corpora/fishcall/callhome/tim/' + item + '.es')
	newFile = open('exp/tri5a/one-best/ch_train/' + item + '.es', 'w+')
	for line in timingFile:
		timeInfo = line.split()
		mergedTranslation = ""
		for timeDetail in timeInfo:
			tmp = findTranscription(timeDetail)
			if tmp != -1:
				mergedTranslation = mergedTranslation + " " + tmp
		mergedTranslation = mergedTranslation.strip()
		transWords = [words[int(x)] for x in mergedTranslation.split()]
		newFile.write(" ".join(transWords) + "\n")
		provFile.write(" ".join(transWords) + "\n")
	newFile.close()
provFile.close()