class Writer(object):
  def __init__(self, tool_file_path, name):
	self.tool_file_path = tool_file_path
	self.name = name
	self.rules_section = ['Rules']
  def AddCustomBuildRule(self, name, cmd, description,
						 additional_dependencies,
						 outputs, extensions):
	rule = ['CustomBuildRule',
			{'Name': name,
			 'ExecutionDescription': description,
			 'CommandLine': cmd,
			 'Outputs': ';'.join(outputs),
			 'FileExtensions': ';'.join(extensions),
			 'AdditionalDependencies':
				 ';'.join(additional_dependencies)
			}]
	self.rules_section.append(rule)
  def WriteIfChanged(self):
	content = ['VisualStudioToolFile',
			   {'Version': '8.00',
				'Name': self.name
			   },
			   self.rules_section
			   ]
	easy_xml.WriteXmlIfChanged(content, self.tool_file_path,
							   encoding="Windows-1252")