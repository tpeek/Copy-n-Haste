def main(args):
  executor = FlockTool()
  executor.Dispatch(args)
class FlockTool(object):
  def Dispatch(self, args):
	if len(args) < 1:
	  raise Exception("Not enough arguments")
	method = "Exec%s" % self._CommandifyName(args[0])
	getattr(self, method)(*args[1:])
  def _CommandifyName(self, name_string):
	return name_string.title().replace('-', '')
  def ExecFlock(self, lockfile, *cmd_list):
	fd = os.open(lockfile, os.O_WRONLY|os.O_NOCTTY|os.O_CREAT, 0666)
	if sys.platform.startswith('aix'):
	  op = struct.pack('hhIllqq', fcntl.F_WRLCK, 0, 0, 0, 0, 0, 0)
	else:
	  op = struct.pack('hhllhhl', fcntl.F_WRLCK, 0, 0, 0, 0, 0, 0)
	fcntl.fcntl(fd, fcntl.F_SETLK, op)
	return subprocess.call(cmd_list)
if __name__ == '__main__':
  sys.exit(main(sys.argv[1:]))