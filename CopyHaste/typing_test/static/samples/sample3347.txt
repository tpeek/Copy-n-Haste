class SetLocale(object):
	def process_request(self, request):
		if os.name == 'nt':
			return
		lang = translation.to_locale(translation.get_language())
		try:
			if lang == 'tr' or lang.startswith('tr_'):
				raise ValueError("Turkish locale broken due to changed "
								 "meaning of lower()")
			locale.setlocale(locale.LC_ALL, (lang, 'UTF-8'))
		except:
			logging.debug('Failed to set locale to %s; using Pootle default',
						  lang)
			set_pootle_locale_
	def process_response(self, request, response):
		set_pootle_locale_
		return response
	def process_exception(self, request, exception):
		set_pootle_locale_
def set_pootle_locale_
	if os.name == 'nt':
		return
	lang = translation.to_locale(settings.LANGUAGE_CODE)
	try:
		if lang == 'tr' or lang.startswith('tr_'):
			raise ValueError("Turkish locale broken due to changed meaning of "
							 "lower()")
		locale.setlocale(locale.LC_ALL, (lang, 'UTF-8'))
	except:
		logging.debug('Failed to set locale to Pootle default (%s); loading '
					  'system default', lang)
		locale.setlocale(locale.LC_ALL, '')