try:
	parentFolder = path.abspath(argv[1])
except:
	print("Usage: combineEbeDatabases.py parent_folder")
	exit()
collector = EbeCollector()
for aSubfolder in listdir(parentFolder):
	subfolder = path.join(parentFolder, aSubfolder)
	if not path.isdir(subfolder): continue
	for aFile in listdir(subfolder):
		if path.splitext(aFile)[1] == ".db":
			print("Merging %s
			if path.splitext(aFile)[0] == "particles":
				collector.mergeparticleDatabases(SqliteDB(path.join(parentFolder, aFile)), SqliteDB(path.join(subfolder, aFile)))
			elif path.splitext(aFile)[0] == "minbiasEcc":
				collector.mergeMinbiasDatabases(SqliteDB(path.join(parentFolder, aFile)), SqliteDB(path.join(subfolder, aFile)))
			else:
				collector.mergeDatabases(SqliteDB(path.join(parentFolder, aFile)), SqliteDB(path.join(subfolder, aFile)))
print("Done.")