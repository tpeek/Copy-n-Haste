__version__ = "0.1"
i8 = _binary.i8
i16 = _binary.i16le
i32 = _binary.i32le
def _accept(prefix):
	return prefix[:4] == b"\0\0\2\0"
class CurImageFile(BmpImagePlugin.BmpImageFile):
	format = "CUR"
	format_description = "Windows Cursor"
	def _open(self):
		offset = self.fp.tell()
		s = self.fp.read(6)
		if not _accept(s):
			raise SyntaxError("not a CUR file")
		m = b""
		for i in range(i16(s[4:])):
			s = self.fp.read(16)
			if not m:
				m = s
			elif i8(s[0]) > i8(m[0]) and i8(s[1]) > i8(m[1]):
				m = s
		self._bitmap(i32(m[12:]) + offset)
		self.size = self.size[0], self.size[1]//2
		d, e, o, a = self.tile[0]
		self.tile[0] = d, (0, 0)+self.size, o, a
		return
Image.register_open("CUR", CurImageFile, _accept)
Image.register_extension("CU