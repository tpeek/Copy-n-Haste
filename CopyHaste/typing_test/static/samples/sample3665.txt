LOG = logging.getLogger(__name__)
@context.configure(name="sahara_image", order=440)
class SaharaImage(context.Context):
	CONFIG_SCHEMA = {
		"type": "object",
		"$schema": consts.JSON_SCHEMA,
		"properties": {
			"image_uuid": {
				"type": "string"
			},
			"image_url": {
				"type": "string",
			},
			"username": {
				"type": "string"
			},
			"plugin_name": {
				"type": "string",
			},
			"hadoop_version": {
				"type": "string",
			}
		},
		"oneOf": [
			{"required": ["image_url", "username", "plugin_name",
						  "hadoop_version"]},
			{"required": ["image_uuid"]}
		],
		"additionalProperties": False
	}
	def _create_image(self, hadoop_version, image_url, plugin_name, user,
					  user_name):
		scenario = glance_utils.GlanceScenario