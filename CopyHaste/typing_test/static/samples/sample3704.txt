class PikaSubscriber(Subscriber):
  
  def __init__(self, device_name, device_id, rabbitmq_address, metric_name):
	super(PikaSubscriber, self).__init__(device_name, device_id, rabbitmq_address)
	self.connection = None
	self.channel = None
	self.queue_name = None
	self.metric_name = metric_name
	
	
  def connect(self):
	credentials = pika.PlainCredentials('cloudbrain', 'cloudbrain')
	self.connection = pika.BlockingConnection(pika.ConnectionParameters(
	  host=self.host, credentials=credentials))
	self.channel = self.connection.channel()
	key = "%s:%s:%s" %(self.device_id,self.device_name, self.metric_name)
	self.channel.exchange_declare(exchange=key,
								  type='direct')
	self.queue_name = self.channel.queue_declare(exclusive=True).metho