__author__ = 'kashida@google.com (Koji Ashida)'
class ThreadListHandler(base.BaseHandler):
	PAGE_NAME_FOR_CSRF = 'editor'
	def get(self, exploration_id):
		self.values.update({
			'threads': feedback_services.get_threadlist(exploration_id)})
		self.render_json(self.values)
	@base.require_user
	def post(self, exploration_id):
		subject = self.payload.get('subject')
		if not subject:
			raise self.InvalidInputException(
				'A thread subject must be specified.')
		text = self.payload.get('text')
		if not text:
			raise self.InvalidInputException(
				'Text for the first message in the thread must be specified.')
		feedback_services.create_thread(
			exploration_id,
			self.payload.get('state_name'),
			self.user_id,
			subject,
			text)
		sel