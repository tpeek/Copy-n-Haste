plugin = Plugin()
bili = Bili()

def get_tmp_dir():
	if len(TEMP_DIR) != 0:
		return TEMP_DIR
	try:
		return tempfile.gettempdir()
	except:
		return TEMP_DIR

def _print_info(info):
	print '[BiliAddon]: ' + info

class BiliPlayer(xbmc.Player):
	def __init__(self):
		self.subtitle = ""
		self.show_subtitle = False

	def setSubtitle(self, subtitle):
		if len(subtitle) > 0:
			self.show_subtitle = True
		else:
			self.show_subtitle = False
		self.subtitle = subtitle

	def onPlayBackStarted(self):
		time = float(self.getTime())
		if self.show_subtitle:
			_print_info(self.subtitle)
			if time > 1:
				_print_info('offset!')
				self.setSubtitles(subtitle_offset(self.subtitle, -time))
			else:
				_print_info('n