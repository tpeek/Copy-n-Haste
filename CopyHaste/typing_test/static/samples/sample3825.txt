if len(sys.argv) != 3:
  print 'usage: <sqlite3 db file> <output json file>'
  sys.exit(-1)
def dict_factory(cursor, row):
  d = {}
  for idx, col in enumerate(cursor.description):
	d[col[0]] = row[idx]
  return d
def save_json(data):
  with codecs.open(sys.argv[2], 'wb', 'utf-8') as out:
	out.write(json.dumps(data, indent=2, sort_keys=True, ensure_ascii=False))
def copydict(d, *keys):
  ret = {}
  for key in keys:
	if type(d[key]) in [str, unicode]:
	  ret[key] = d[key].strip()
	else:
	  ret[key] = d[key]
  return ret
artists = {}
major_tags = {}
major_tags_rel = defaultdict(list)
minor_tags = {}
minor_tags_rel = defaultdict(list)
works = []
try:
  con = db.connect(sys.argv[1])
  with con:	
	con.text_factory = lambda x: unicode(x, 'utf-8')