__version__ = '0.3.2'

BASE_URL = 'http://lpo.dt.navy.mil/data/DM'	   
			 
def get_data_for_date(date):
	if date.year < 2007:
		return _get_data_pre2007(date)
	else:
		return _get_data_post2006(date)
	   
def _get_data_pre2007(date):
	url = '{}/Environmental_Data_{}.txt'.format(BASE_URL, date.year)
	print('Fetching online data for {} (full year)'.format(date.year))
	
	try:
		year_data = request.urlopen(url).read().decode(encoding='utf_8').split('\n')			
	except:
		raise ValueError(date)
	else:
		year_data.pop(0)
	
	for line in year_data:
		
		elements = line.split()
		yield dict(Date = elements[0],
		   Time = elements[1],
		   Status = 'COMPLETE',
		   Air_Temp = elements[5],
		   Barometric_Press = elements[7],
		