class Record:
	pass
def validate(fn, check_indent=True):
	text = open(fn).read()
	state = Record()
	def NoStartTag(end_tag):
		raise Exception( % (fn, end_tag, state.line, state.col))
	def start_tag_matcher(s, start_tag):
		start_line = state.line
		start_col = state.col
		state.depth += 1
		old_matcher = state.matcher
		def f(end_tag):
			problem = None
			if start_tag != end_tag:
				problem = 'Mismatched tag.'
			elif check_indent and state.line > start_line + 1 and state.col != start_col:
				problem = 'Bad indentation.'
			if problem:
				raise Exception( % (fn, problem, s, start_line, start_col, end_tag, state.line, state.col))
			state.matcher = old_matcher
			state.depth -= 1
		state.matcher = f
	state.depth = 0
	state.i = 0
	state.