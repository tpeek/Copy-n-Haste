def encrypt(mode, key, iv, plaintext):
	cipher = base.Cipher(
		algorithms.CAST5(binascii.unhexlify(key)),
		mode(binascii.unhexlify(iv)),
		default_backend()
	)
	encryptor = cipher.encryptor()
	ct = encryptor.update(binascii.unhexlify(plaintext))
	ct += encryptor.finalize()
	return binascii.hexlify(ct)
def build_vectors(mode, filename):
	vector_file = open(filename, "r")
	count = 0
	output = []
	key = None
	iv = None
	plaintext = None
	for line in vector_file:
		line = line.strip()
		if line.startswith("KEY"):
			if count != 0:
				output.append("CIPHERTEXT = {}".format(
					encrypt(mode, key, iv, plaintext))
				)
			output.append("\nCOUNT = {}".format(count))
			count += 1
			name, key = line.split(" = ")
			output.append("KEY = {}".for