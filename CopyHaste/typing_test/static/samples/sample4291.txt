print_function)
__license__ = 'GPL v3'
__copyright__ = '2014, Kovid Goyal <kovid at kovidgoyal.net>'
d, j, a = (getattr(os.path, x) for x in ('dirname', 'join', 'abspath'))
base = d(a(__file__))
os.chdir(base)
imgsrc = j(d(d(base)), 'imgsrc')
sources = {'calibre':j(d(base), 'calibre.png'), 'ebook-edit':j(imgsrc, 'tweak.svg'), 'ebook-viewer':j(imgsrc, 'viewer.svg'), 'book':j(imgsrc, 'book.svg')}
for name, src in sources.iteritems():
	iconset = name + '.iconset'
	if os.path.exists(iconset):
		shutil.rmtree(iconset)
	os.mkdir(iconset)
	os.chdir(iconset)
	try:
		for sz in (16, 32, 128, 256, 512, 1024):
			iname = 'icon_{0}x{0}.png'.format(sz)
			iname2x = 'icon_{0}x{0}@2x.png'.format(sz // 2)
			if src.endswith('.svg'):
				subprocess.check_cal