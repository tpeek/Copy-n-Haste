class APIError(Exception):
	pass
class APIClient(object):
	def __init__(self, version):
		self.version = version
	def dispatch(self, url, method, data=None):
		url = '%s/api/%d/%s' % (current_app.config['BASE_URI'], self.version, url.lstrip('/'))
		with current_app.test_client() as client:
			response = client.open(path=url, method=method, data=data)
		if not (200 <= response.status_code < 300):
			raise APIError('Request returned invalid status code: %d' % (response.status_code,))
		if response.headers['Content-Type'] != 'application/json':
			raise APIError('Request returned invalid content type: %s' % (response.headers['Content-Type'],))
		return json.loads(response.data)
	def delete(self, *args, **kwargs):
		return self.dispatch(method=