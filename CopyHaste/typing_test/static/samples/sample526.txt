
class TimeoutError(Exception):
	pass
class Datasrc(object):
	def __init__(self, length=0):
		self.length = length
		self.cursor = -1
		self.datums = {}
		self.history = []
		self.sortedkeys = []
		self.cond = threading.Condition()
		self.newdata = threading.Event()
	def __getitem__(self, key):
		with self.cond:
			return self.datums[key]
	def __setitem__(self, key, value):
		self.push(key, value)
	def __contains__(self, key):
		with self.cond:
			return key in self.datums
	def has_key(self, key):
		with self.cond:
			return key in self.datums
	def __delitem__(self, key):
		self.remove(key)
	def __len__(self):
		with self.cond:
			return len(self.history)
	def push(self, key, value):
		with self.cond:
			if key in self.history:
				self.his