
class ColorDistError(Exception):
	pass
class ColorDistBase(object):
	def __init__(self, hashsize, colorlen=None):
		super(ColorDistBase, self).__init__()
		self.hashsize = hashsize
		if colorlen is None:
			colorlen = 256
		self.colorlen = colorlen
		self.maxhashsize = 1024*1024
		self.hash = None
		self.calc_hash()
	def hash_array(self, idx):
		idx = idx.clip(0, self.hashsize-1)
		arr = self.hash[idx]
		return arr
		
	def get_hash_size(self):
		return self.hashsize
	
	def set_hash_size(self, size):
		assert (size >= self.colorlen) and (size <= self.maxhashsize), \
			   ColorDistError("Bad hash size!")
		self.hashsize = size
		self.calc_hash()
	def check_hash(self):
		hashlen = len(self.hash)
		assert hashlen == self.hashsize, \
			   Col