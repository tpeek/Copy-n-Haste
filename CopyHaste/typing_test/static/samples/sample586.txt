
class JHBuildSource(steps.source.Source):
	name = "jhbuild"
	def __init__ (self, moduleset=None, module=None, stage=None, **kwargs):
		steps.source.Source.__init__(self, **kwargs)
		self.moduleset = moduleset
		self.module = module
		self.name = module + ' update'
		self.description = [module + ' updating']
		self.descriptionDone = [module + ' updated']
	def computeSourceRevision(self, changes):
		if not changes:
			return None
		try:
			return max([int(c.revision) for c in changes])
		except ValueError:
			return changes[-1].revision
	def startVC(self, branch, revision, patch):
		command = ['jhbuild']
		if (self.moduleset is not None):
			command += ['--moduleset='+self.moduleset]
		command += ['bot', '--step', 'updateone', self.module]
	