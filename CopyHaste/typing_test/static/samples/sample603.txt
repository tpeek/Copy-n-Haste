
if __name__ == '__main__':
	account_ids = None
	dry_run = False
	if len(sys.argv) != 1:
		if sys.argv[1] == '-p':
			dry_run = True
		else:
			account_ids = [int(num) for num in sys.argv[1:]]
	failed_accounts = []
	with session_scope() as db_session:
		accounts = db_session.query(Account).filter(
			Account.discriminator =='gmailaccount')
		if account_ids is not None:
		   accounts = accounts.filter(Account.id.in_(account_ids))
		accounts_list = [account for account in accounts]
		for account in accounts_list:
			db_session.expunge(account)
		if dry_run:
			print [account.id for account in accounts_list]
			sys.exit(0)
	for account in accounts_list:
		ret = os.system("bin/refresh_imapuid_labels %d" % account.id)
		if os.WEXITSTATUS(ret) !=