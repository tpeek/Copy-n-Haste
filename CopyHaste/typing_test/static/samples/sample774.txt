
class QemuImgInfo(object):
	BACKING_FILE_RE = re.compile((r"^(.*?)\s*\(actual\s+path\s*:"
								  r"\s+(.*?)\)\s*$"), re.I)
	TOP_LEVEL_RE = re.compile(r"^([\w\d\s\_\-]+):(.*)$")
	SIZE_RE = re.compile(r"(\d*\.?\d+)(\w+)?(\s*\(\s*(\d+)\s+bytes\s*\))?",
						 re.I)
	def __init__(self, cmd_output=None):
		details = self._parse(cmd_output or '')
		self.image = details.get('image')
		self.backing_file = details.get('backing_file')
		self.file_format = details.get('file_format')
		self.virtual_size = details.get('virtual_size')
		self.cluster_size = details.get('cluster_size')
		self.disk_size = details.get('disk_size')
		self.snapshots = details.get('snapshot_list', [])
		self.encrypted = details.get('encrypted')
	def __str__(self):
		lines =