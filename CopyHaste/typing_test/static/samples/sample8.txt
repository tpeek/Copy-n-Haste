
class Sequence:
	def __init__(self, name, seq):
		self.name = name
		self.seq = seq
class SequenceIO:
	def _readfq(self, fp):
		last = None
		while True:
			if not last:
				for l in fp:
					if l[0] in '>@':
						last = l[:-1]
						break
			if not last: break
			name, seqs, last = last[1:].partition(" ")[0], [], None
			for l in fp:
				if l[0] in '@+>':
					last = l[:-1]
					break
				seqs.append(l[:-1])
			if not last or last[0] != '+':
				yield name, ''.join(seqs), None
				if not last: break
			else:
				seq, leng, seqs = ''.join(seqs), 0, []
				for l in fp:
					seqs.append(l[:-1])
					leng += len(l) - 1
					if leng >= len(seq):
						last = None
						yield name, seq, ''.join(seqs);
						break
				if last:
					yield name, 