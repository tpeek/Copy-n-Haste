
start_time = time.time()
phase = "02"
def create_ngram_model(params=None):
	tfidf_ngrams = TfidfVectorizer(ngram_range=(1, 3),
								   analyzer="word", binary=False)
	clf = MultinomialNB()
	pipeline = Pipeline([('vect', tfidf_ngrams), ('clf', clf)])
	if params:
		pipeline.set_params(**params)
	return pipeline
def grid_search_model(clf_factory, X, Y):
	cv = ShuffleSplit(
		n=len(X), n_iter=10, test_size=0.3, random_state=0)
	param_grid = dict(vect__ngram_range=[(1, 1), (1, 2), (1, 3)],
					  vect__min_df=[1, 2],
					  vect__stop_words=[None, "english"],
					  vect__smooth_idf=[False, True],
					  vect__use_idf=[False, True],
					  vect__sublinear_tf=[False, True],
					  vect__binary=[False, True],
					  clf__alpha=[0, 0.01, 0.05, 