
update_translations = "RENPY_UPDATE_TRANSLATIONS" in os.environ
class Formatter(string.Formatter):
	def parse(self, s):
		LITERAL = 0
		OPEN_BRACKET = 1
		VALUE = 3
		FORMAT = 4
		CONVERSION = 5
		bracket_depth = 0
		literal = ''
		value = ''
		format = ''
		conversion = None
		state = LITERAL
		for c in s:
			if state == LITERAL:
				if c == '[':
					state = OPEN_BRACKET
					continue
				else:
					literal += c
					continue
			elif state == OPEN_BRACKET:
				if c == '[':
					literal += c
					state = LITERAL
					continue
				else:
					value = c
					state = VALUE
					bracket_depth = 0
					continue
			elif state == VALUE:
				if c == '[':
					bracket_depth += 1
					value += c
					continue
				elif c == ']':
					if bracket_depth