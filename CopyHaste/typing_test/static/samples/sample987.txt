
with open('outgoing.msg', 'rb') as fp:
	msg = BytesParser(policy=policy.default).parse(fp)
print('To:', msg['to'])
print('From:', msg['
print('Subject:', msg['subject'])
simplest = msg.get_body(preferencelist=('plain', 'html'))
print()
print(''.join(simplest.get_content().splitlines(keepends=True)[:3]))
ans = input("View full message?")
if ans.lower()[0] == 'n':
	sys.exit()
richest = msg.get_body()
partfiles = {}
if richest['content-type'].maintype == 'text':
	if richest['content-type'].subtype == 'plain':
		for line in richest.get_content().splitlines():
			print(line)
		sys.exit()
	elif richest['content-type'].subtype == 'html':
		body = richest
	else:
		print("Don't know how to display {}".format(richest.get_content_type()))
		sys.exit(